{% comment %}
Template de perfil del aprendiz

Este template permite al aprendiz ver y editar su información personal.
Tiene dos estados:
1. Vista de perfil: Muestra la información actual del usuario
2. Edición de perfil: Formulario para modificar nombre, apellido y correo

Funcionalidades:
- Visualización de información del usuario con avatar generado por iniciales
- Botón para activar el modo de edición
- Formulario de edición con validación
- JavaScript para alternar entre vista y edición
{% endcomment %}
{% extends 'base.html' %}
{% load static %}

{% block content %}
  <div class="admin-container">
    {% comment %}
    Tarjeta de visualización del perfil
    Muestra la información actual del usuario de forma solo lectura
    {% endcomment %}
    <div class="perfil-card">
      <div class="sticky-sync-wrapper">
        <button type="button" class="btn-back-small" onclick="window.location.href='{% url 'principal-aprendiz' %}'" aria-label="Volver">
          ←
        </button>
          
        <div class="slide" id="slideSync">
          <img src="{% static 'img/logo-dotapp-sena.png' %}" alt="Logo DotApp SENA" class="logo" />
        </div>
      </div>

      {% comment %}
      Avatar generado con las iniciales del nombre y apellido
      Se muestra en un círculo con las primeras letras en mayúsculas
      {% endcomment %}
      <div class="avatar-circle">
        {{ usuario.nombre|first|upper }}{{ usuario.apellido|first|upper }}
      </div>

      {% comment %}
      Información del usuario en formato de columnas
      Muestra nombre, apellido y correo electrónico
      {% endcomment %}
      <div class="info-row">
        <div class="info-col">
          <label>Nombres</label>
          <span class="value">{{ usuario.nombre }}</span>
        </div>
        <div class="info-col">
          <label>Apellidos</label>
          <span class="value">{{ usuario.apellido }}</span>
        </div>
      </div>

      <div class="info-row">
        <div class="info-col">
          <label>Correo Electrónico</label>
          <span class="value">{{ usuario.correo }}</span>
        </div>
      </div>
      <br>

      {% comment %}
      Botón para activar el modo de edición
      Al hacer clic, oculta la vista y muestra el formulario de edición
      {% endcomment %}
      <button type="button" class="btn-editar-perfil">Editar perfil</button>
    </div>

    {% comment %}
    Tarjeta de edición del perfil
    Inicialmente oculta, se muestra al hacer clic en "Editar perfil"
    Contiene el formulario para modificar la información del usuario
    {% endcomment %}
    <div class="login-card perfil-buttons-card">
      <div class="perfil-buttons">
        <img src="{% static 'img/logo-dotapp-sena.png' %}" alt="Logo DotApp SENA" class="logo" />
        <h1>Editar Perfil</h1>
        <br>
        {% comment %}
        Formulario de edición de perfil
        Permite modificar nombre, apellido y correo electrónico
        Los campos se prellenan con los valores actuales del usuario
        {% endcomment %}
        <form class="perfil-buttons" action="{% url 'actualizar_perfil' %}" method="POST">
            {% csrf_token %}
            
            <div class="form-group">
                <input type="text" id="nombre" name="nombre" required value="{{ usuario.nombre }}">
                <label for="nombre">Nombres</label>
            </div>

            <div class="form-group">
                <input type="text" id="apellido" name="apellido" required value="{{ usuario.apellido }}">
                <label for="apellido">Apellidos</label>
            </div>

            <div class="form-group">
                <input type="email" id="correo" name="correo" required value="{{ usuario.correo }}">
                <label for="correo">Correo electrónico</label>
            </div>

            <br>

            <button type="submit">Guardar Cambios</button>
        </form>
      </div>
    </div>
  
  </div>
{% endblock %}

{% block scripts %}
{% comment %}
Script para alternar entre vista y edición del perfil
Oculta la tarjeta de visualización y muestra el formulario de edición
{% endcomment %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Ocultar formulario de edición al cargar la página
    document.querySelector('.login-card.perfil-buttons-card').style.display = 'none';

    /**
     * Muestra el formulario de edición y oculta la vista del perfil
     * Se activa al hacer clic en el botón "Editar perfil"
     */
    document.querySelector('.btn-editar-perfil').onclick = function () {
      document.querySelector('.login-card.perfil-buttons-card').style.display = 'block';
      document.querySelector('.perfil-card').style.display = 'none';
    };
  });
</script>
{% endblock %}